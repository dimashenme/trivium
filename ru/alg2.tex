\documentclass[12pt]{article}

%\usepackage{theorem,amsmath,amssymb,russcorr}
\usepackage{amsthm,amsmath,amssymb}
\usepackage{color}
\usepackage[koi8-r]{inputenc}
\usepackage[russianb]{babel}

\input{listki.tex}

\newcommand{\delit}{\operatorname{\vdots}}

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Для зачета по каждому листку достаточно сдать все задачи со
звездочками, либо все задачи без звездочек. Задачи с двумя
звездочками можно не сдавать. Сдавшим $k$ задач с двумя звездочками
разрешается не сдавать $2k$ задач со звездочками из того же
листочка. Задачи, обозначенные (!), следует сдавать всем.

\listok{2}{АЛГЕБРА 2: делимость в кольцах и алгоритм Евклида}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subs{Наибольший общий делитель}

Пусть $R$ --- кольцо.

\begin{opredelenie}
{\bf Делители нуля} в кольце $R$ это такие ненулевые элементы
$x$, $y$, что $xy=0$. 
$R$ называется {\bf областью целостности}, если в $R$ нет
делителей нуля.
\end{opredelenie}

На протяжении этого листка, все кольца предполагаются
областями целостности.

\begin{opredelenie}
Обратимый элемент в $R$ называется {\bf единицей} кольца $R$.
\end{opredelenie}

\begin{zadacha} 
Целые гауссовы числа -- это комплексные числа вида $x + y \1$, где
$x$, $y$ целые. Докажите, что они образуют кольцо. Оно обозначается
$\Z[\1]$.
\end{zadacha}

\begin{zadacha} Опишите все единицы в кольце целых гауссовых чисел.
\end{zadacha}

\begin{ukazanie} Если комплексное число $z$ обратимо в $\Z[\1]$,
то $z \bar z$ тоже обратимо в $\Z[\1]$.
\end{ukazanie}

\begin{zadacha} Зафиксируем целое положительное число $n$.
Рассмотрим множество всех комплексных чисел вида $x + y \sqrt{-n}$,
где $x$, $y$ целые. Докажите, что это кольцо.
\end{zadacha}

\begin{zadacha}[*]
Зафиксируем целое положительное нечетное число $n$.  Рассмотрим
множество всех комплексных чисел вида $\frac{x + y \sqrt{-3}}2$, где
$x$, $y$ одновременно четные либо одновременно нечетные.  Докажите,
что это кольцо, и опишите все единицы.  Мы обозначим это кольцо
$\widetilde{\Z[\sqrt{-3}]}$.
\end{zadacha}

\begin{opredelenie}
Пусть $R$ кольцо, $x, y\in R$ элементы $R$.  Если $x= yz$ в $R$, то
говорят, что $x$ {\bf делится} на $y$ в $R$, а $y$ {\bf делит} $x$.
Отношение делимости обозначается $x\delit y$.
\end{opredelenie}

\begin{opredelenie} 
Пусть $R$ --- кольцо, $x, y\in R$ элементы $R$. {\bf Наибольший
общий делитель} (НОД) $x, y$ --- это такой элемент $z\in R$, что $z$
делит $x$ и $y$, и для всякого $z'$, делящего $x$, $z'$ делит
$z$. $x$ и $y$ называются {\bf взаимно простыми}, если $1$ --
наибольший общий делитель $x,y$.
\end{opredelenie}

Вообще говоря, в произвольном кольце для произвольных элементов НОД
может и не существовать.

\begin{zadacha}
Докажите, что если НОД существует, то он единственный с точностью до
единицы: если $z$ и $z'$ -- наибольшие общие делители $x$ и $y$ в
кольце $R$, то $z = e z'$, где $e$ -- единица кольца $R$.
\end{zadacha}

\begin{zadacha} Пусть $\Q(2)$ - множество всех рациональных чисел,
представленных дробями вида $\frac p q$ с нечетным знаменателем $q$.
Докажите, что это множество замкнуто относительно умножения и
сложения и образует подкольцо в кольце рациональных чисел.
\end{zadacha}

\begin{zadacha} Приведите пример необратимого элемента в $\Q(2)$.
\end{zadacha}

\begin{zadacha} Опишите единицы кольца $\Q(2)$.
\end{zadacha}

\begin{zadacha}[!] Докажите, что в $\Q(2)$ существует
наибольший общий делитель любых двух элементов.
\end{zadacha}

\begin{ukazanie} Докажите, что любой элемент $\Q(2)$ представим
в виде $e 2^n$, где $e$ --- единица.
\end{ukazanie}

\begin{opredelenie} Пусть $p$ -- элемент кольца $R$. Он называется
{\bf простым}, если для любых $q,r$ с $p=qr$ либо $q$, либо $r$ --
единица кольца $R$.
\end{opredelenie}

\begin{zadacha} Опишите все простые элементы в $\Q(2)$.
\end{zadacha}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subs{Делимость в кольце целых чисел}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{zadacha} Пусть $x$, $y$ -- целые положительные числа,
а $z= (x - ky)$ --- остаток от деления $x$ на $y$. Докажите, что
если НОД($y,z$) существует, то НОД($x,y$) также существует, и равен
НОД($y,z$).
\end{zadacha}

\begin{opredelenie} 
Алгоритм Евклида берет два целых положительных числа $x$, $y$,
$x>y$, и выдает целое положительное число $z$.
\begin{enumerate}
\item Если $x$ делится на $y$, алгоритм заканчивает свою работу и
выдает в качестве результата $y$.

\item Если $x$ не делится на $y$, алгоритм повторяет свою работу,
примененный к числам $x_1 = y$, $y_1= x - ky$, где $x - ky$ остаток
от деления $x$ на $y$.
\end{enumerate}
\end{opredelenie}

\begin{zadacha} Докажите, что алгоритм Евклида заканчивает
свою работу после конечного числа итераций
\end{zadacha}

\begin{zadacha} Докажите, что результат применения
алгоритма Евклида к целым числам $x,y$ является НОД($y,z$)
\end{zadacha}

\begin{zadacha}
Решите задачу 1.26 из листка 1 (если вы ее еще не решили).
\end{zadacha}

\begin{zadacha} Докажите, что результат применения
алгоритма Евклида к числам $x$, $y$ выражается как линейная
комбинация $x$ и $y$ с целыми коэффициентами: $z = ax + by$.
\end{zadacha}

\begin{zadacha} Пусть $x$, $y$ -- взаимно простые 
целые числа, а $p$ -- простое число. Предположим, что $xy$ делится
на $p^\alpha$ для некоторого натурального $\alpha$. Докажите, что
или $x$ делится на $p^\alpha$, или $y$ делится на $p^\alpha$.
\end{zadacha}

\begin{zadacha}[!] Выведите из этого однозначность
разложения на простые множители: если целое положительное число $x$
представлено в виде произведения простых чисел двумя способами, то
эти два способа отличаются лишь порядком сомножителей.
\end{zadacha}

\begin{ukazanie} Запишите $x$ в виде произведения
$p_i^{\alpha_i}$, где $p_i$ разные простые числа, и воспользуйтесь
предыдущей задачей, чтобы убедиться, что показатель $\alpha_i$
определен однозначно.
\end{ukazanie}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subs{Факториальные кольца}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{opredelenie}
Пусть $R$ -- кольцо. Два разложения $r\in R$ на простые множители,
$r = p_1 p_2 ... p_k$, $r = q_1 q_2 ... q_k$ называются
эквивалентными, если после некоторой перестановки сомножителей $p_i$
и домножения простых сомножителей $p_i$ на единицы кольца мы получим
разложение $r = q_1 q_2 ... q_k$.  Мы говорим, что $R$ {\bf
факториальное}, или же {\bf кольцо с однозначным разножением на
множители}, если для любого $r\in R$ разложение $r$ в произведение
простых чисел существует и единственно с точностью до эквивалентности.
\end{opredelenie}

\begin{zamechanie} Термин ``факториальное'' звучит страшно, но он, увы,
вошел в традицию; по-английски, например, то же самое называется
куда более понятным словосочетанием unique factorization ring
(буквально ``кольцо с единственным разложением'').
\end{zamechanie}

\begin{zadacha}[!] Пусть в кольце $R$ существует разложение на 
простые множители, и наибольший
общий делитель $z$ любой пары элементов $x, y$.  Пусть к тому же $z$
выражается в $R$ как линейная комбинация $x, y$: $z = ax + by$ с
коэффициентами $a,b \in R$. Докажите, что $R$ -- факториальное
кольцо.
\end{zadacha}

\begin{ukazanie} Воспользуйтесь доказательством, приведенным
выше для целых чисел.
\end{ukazanie}

\begin{zadacha} Зафиксируем целое положительное 
число $n$. Рассмотрим кольцо $\Z[\sqrt{-n}] \subset \C$ комплексных
чисел вида $z= x + y \sqrt{-n}$, $x$ и $y$ целые. Докажите, что
$|z|^2$ -- целое для всех $z\in \Z[\sqrt{-n}]$.
\end{zadacha}

\begin{zadacha} Докажите, что $z$ -- единица в $\Z[\sqrt{-n}]$
тогда и только тогда, когда $|z|^2=1$.
\end{zadacha}

\begin{ukazanie} $|z^{-1}|^2 = (|z|^2)^{-1}$.
\end{ukazanie}

\begin{zadacha}\label{prime.gauss} 
Пусть $z$ -- такой элемент $\Z[\sqrt{-n}]$, что $|z|^2$ просто в
$\Z$. Докажите, что $z$ просто в $\Z[\sqrt{-n}]$.
\end{zadacha}

\begin{ukazanie} $|z z'|^2 = |z|^2 |z'|^2$.
\end{ukazanie}

\begin{zadacha}[!] Рассмотрим кольцо $\Z[\sqrt{-3}]$.
Докажите, что $2$ и $1\pm \sqrt{-3}$ простые. Выведите из этого, что
$\Z[\sqrt{-3}]$ не факториально.
\end{zadacha}

\begin{ukazanie} Воспользуйтесь соотношением $2^2 =4$.
\end{ukazanie}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subs{Деление с остатком в кольцах}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{opredelenie} Пусть $R$ некоторое кольцо.
Мы говорим, что в $R$ {\bf задано деление с остатком}, если для
каждой пары $x, y$, $y\neq 0$ в $R$ заданы $z, k\in R$,
удовлетворяющее соотношению $z = x - ky$. В этом случае $z$
называется {\bf остатком от деления} и $k$ {\bf частным}.
\end{opredelenie}

\noindent
{\bf Примеры.} Деление с остатком задано в кольце целых чисел. Еще
деление с остатком задано в кольце полиномов $k[t]$ над полем $k$:
$$
\arraycolsep=0.05em
\begin{array}{rrr@{\,}r|r}
x^2&{}+2x&{}-12&&\,x+5\\
\cline{5-5}
x^2&{}+5x&&&\,x-3\\
\cline{1-2}
&{}-3x&{}-12\\
&{}-3x&{}-15\\
\cline{2-3}
&&3
\end{array}
$$

\begin{opredelenie} Пусть в кольце $R$ задано деление
с остатком. {\bf Алгоритм Евклида в $R$} применяется к паре $x, y$
ненулевых элементов из $R$ и определяется рекурсивно. Если $x$
делится на $y$, алгоритм Евклида останавливается и выдает в качестве
результата $y$.  Если же $x$ не делится на $y$, то алгоритм Евклида
применяется к паре $y, z$, где $z$ есть остаток от деления $x$ на
$y$. Априори, этот процесс может длиться бесконечно.
\end{opredelenie}

\begin{zadacha}[!] Пусть в кольце $R$ задано деление
с остатком. Предположим, что алгоритм Евклида, примененный к паре
$x, y\in R$, остановился через какое-то число шагов и выдал в
качестве результата $z\in R$. Докажите, что
\begin{enumerate}
\item $z = a x + by$ для каких-то $a, b \in R$.

\item $z$ есть наибольший общий делитель $x$ и $y$.
\end{enumerate}
\end{zadacha}

\begin{ukazanie} Доказательство в случае произвольного кольца
дословно такое же, как и для кольца целых чисел.
\end{ukazanie}

\begin{opredelenie} Пусть $R$ кольцо. Говорится, что {\bf в $R$
существует алгоритм Евклида}, или же {\bf $R$ евклидово} если в $R$
задано деление с остатком, и для любых $x, y\in R$ алгоритм Евклида
заканчивается через конечное число шагов.
\end{opredelenie}

\begin{zadacha}[!] Пусть в кольце $R$ существует разложение на 
простые множители и алгоритм Евклида.
Докажите, что $R$ факториально.
\end{zadacha}

\begin{ukazanie} Воспользуйтесь вышеприведенными задачами
\end{ukazanie}

\begin{zadacha} Докажите, что кольцо $k[t]$ многочленов
над полем $k$ факториально.
\end{zadacha}

\begin{zadacha} Докажите, что уравнение $x \cdot y=0$
неразрешимо (для $x,y \neq 0$) в $k[t] \mod P$ тогда и только тогда,
когда многочлен $P$ неприводим.
\end{zadacha}

Целая часть $[z]$ комплексного числа $z= x + y \1$ определяется как
$[x+0.5] + [y+0.5]\1$, где $[\ ]$ обозначает операцию взятия целой
части для вещественного числа (если интерпретировать комплексные
числа геометрически как точки плоскости $\R^2$, то $[z]$ --
ближайшая к $z$ точка с целыми координатами). Деление с остатком в
кольце $\Z[\1]$ целых гауссовых чисел определяется следующим
образом: частное от деления с остатком $z_1$ на $z_2$ равно $[\frac
{z_1}{z_2}]$, а остаток равен $z_1 - [\frac {z_1}{z_2}]z_2$.

\begin{zadacha}
Докажите, что $\left|z_1 - \left[\frac {z_1}{z_2}\right]z_2\right| <
|z_2|$.
\end{zadacha}

\begin{zadacha} 
Докажите что в кольце $\Z[\1]$ целых гауссовых чисел алгоритм
Евклида всегда заканчивается.
\end{zadacha}

\begin{ukazanie} Воспользуйтесь предыдущей задачей.
Выведите, что на каждом шаге алгоритма Евклида уменьшается
$\min(|z_1|^2, |z_2|^2)$.
\end{ukazanie}

Пусть $R=\Z[\sqrt{-n}]$ или $R=\widetilde{\Z[\sqrt{-3}]}$. Для
любого $z\in \C$ обозначим за $[z]_R$ ближайшую к $z$ точку
комплексной плоскости, соответствующую числу из $R$. Если таких
точек несколько, возьмем ту, в которой значение $Re [z]_R$ 
(вещественной части) больше, а
если и таких точек несколько -- возьмем ту, у которой $Im [z]_R$
(мнимая часть) больше. Определим деление $z_1$ на $z_2$ 
с остатком таким образом, что частное от деления с 
остатком $z_1$ на $z_2$ равно 
$[\frac{z_1}{z_2}]_R$, а остаток равен $z_1 - [\frac {z_1}{z_2}]_Rz_2$.

\begin{zadacha}[*] Докажите, что при
$n=1$ мы получим стандартное деление с остатком в $\Z[\1]$
\end{zadacha}

\begin{zadacha}[*] 
Пусть $\left|z - [z]_R\right|<1$ для всех $z\in \C$. Докажите, что
на каждом шаге алгоритма Евклида уменьшается 
$|z_2|^2$.
\end{zadacha}

\begin{zadacha}[*] 
Пусть для каждой точки $z\in \C$ найдется $r\in R$ такой, что
$|r-z|<1$. Докажите, что $R$ евклидово.
\end{zadacha}

\begin{zadacha}[*] 
Докажите, что следующие кольца евклидовы: $\Z[\sqrt{-2}]$,
$\widetilde{\Z[\sqrt{-3}]}$.
\end{zadacha}

\begin{zadacha} Разложите число 2 на простые сомножители в
$\Z[\1]$.
\end{zadacha}

\begin{ukazanie} Воспользуйтесь задачей~\ref{prime.gauss}.
\end{ukazanie}

\begin{zadacha}[*] Разложите числа 3, 5, 7 на простые сомножители в
$\Z[\1]$.
\end{zadacha}

\begin{zadacha}[*] Докажите, что простое в $\Z$ число вида $p=4k+3$
всегда просто в $\Z[\1]$.
\end{zadacha}

\begin{ukazanie} Докажите, что $p$ не представимо в виде суммы квадратов
\end{ukazanie}

\begin{zadacha} Пусть $z= a + b \1$ целое гауссово число,
которое не делится на $1 + \1$. Предположим, что $a$ и $b$ взаимно
просты. Докажите, что $z$ и $\bar z$ взаимно просты.
\end{zadacha}

\begin{ukazanie} Докажите, что если $a$ и $b$ взаимно просты в $\Z$,
то 2 можно представить в виде линейной комбинации $a + b \1$, $a - b
\1$.
\end{ukazanie}

\begin{zadacha}[!] Пусть $a, b, c$ -- такие взаимно простые 
целые числа, что $a^2 + b ^2 = c^2$. Докажите, что $c= |z|^2$,
для какого-то $z\in\Z[\1]$.
\end{zadacha}

\begin{ukazanie} Воспользуйтесь тем, что $c^2 = (a + b \1)(a - b \1)$,
а $a, b$ взаимно просты. Примените единственность разложения на простые
множители в $\Z[\1]$, и выведите из этого, что 
каждый простой сомножитель $a + b \1$, $a - b \1$
встречается дважды. 
\end{ukazanie}

\begin{zadacha}[!] Укажите все тройки 
целых чисел $a, b, c$, таких, что $a^2 + b ^2 = c^2$ (``укажите''
следует понимать как ``напишите формулу, которая дает все такие
тройки при подстановке в нее целых чисел'').
\end{zadacha}

\begin{ukazanie} Воспользуйтесь предыдущей задачей.
\end{ukazanie}

\begin{zadacha}[*] Укажите все тройки взаимно простых
целых чисел $a, b, c$, таких, что $a^2 + 2 b ^2 = c^2$.
\end{zadacha}

\begin{zadacha} Примените однозначность разложения на множители
в $\Z[\sqrt{-2}]$
\end{zadacha}

\begin{zadacha}[**] Укажите все тройки взаимно простых
целых чисел $a, b, c$, таких, что $a^2 + 3 b ^2 = c^2$.
\end{zadacha}

\end{document}
